<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirect</title>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
        window.addEventListener('load', function() {
            // Если уже во внешнем браузере (параметр ext=1) — ничего не делаем
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('ext')) return;

            // Проверяем, что мы внутри Telegram in-app браузера
            const isTelegramInApp = 
                (window.Telegram && window.Telegram.WebApp) ||
                (typeof window.TelegramWebview !== 'undefined') ||
                /telegram/i.test(navigator.userAgent);

            if (!isTelegramInApp) return;

            // Целевая ссылка — ЗАМЕНИ ЭТУ НА СВОЮ
            let targetUrl = "https://go.mavrtracktor.com?userId=b186e26ed1cc5be3bd4fd0bddec376c2ef5e97201a8d267599c1d0839eff9d9c";  

            // Добавляем параметр, чтобы избежать зацикливания
            if (!targetUrl.includes('?')) {
                targetUrl += '?ext=1';
            } else {
                targetUrl += '&ext=1';
            }

            // 1. Официальный метод Telegram (iOS + часть Android)
            if (window.Telegram && window.Telegram.WebApp && typeof Telegram.WebApp.openLink === 'function') {
                Telegram.WebApp.openLink(targetUrl);
                return;
            }

            // 2. Intent-хак для Android
            const ua = navigator.userAgent.toLowerCase();
            if (ua.includes('android')) {
                const hostPath = targetUrl.replace(/^https?:\/\//, '');
                const intentUrl = `intent://${hostPath}#Intent;scheme=https;end`;
                window.location.href = intentUrl;
            }
        });
    </script>
</head>
<body>
    <!-- Пустое тело — ничего не показываем -->
</body>
</html>
